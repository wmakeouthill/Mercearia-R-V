<div class="caixa-container">
  <div class="top-bar">
    <div class="filtros">
      <label>
        Data
        <input type="date" [(ngModel)]="dataSelecionada" (change)="onChangeData()" />
      </label>
    </div>
    <div class="form-mov">
      <h3>Nova Movimenta√ß√£o</h3>
      <label>
        Tipo
        <select [(ngModel)]="tipo">
          <option value="entrada">Entrada</option>
          <option value="retirada">Retirada</option>
        </select>
      </label>
      <label>
        Valor
        <input type="number" [(ngModel)]="valor" min="0" step="0.01" />
      </label>
      <label class="flex-1">
        Descri√ß√£o
        <input type="text" [(ngModel)]="descricao" placeholder="Opcional" />
      </label>
      <button (click)="registrar()" [disabled]="loading">Registrar</button>
    </div>
  </div>

  <div class="resumo" *ngIf="resumoVendasDia">
    <div class="card">
      <div class="titulo">Receita de Vendas (dia)</div>
      <div class="valor positivo">
        R$ {{ totalVendasHoje | number:'1.2-2' }}
      </div>
    </div>
    <div class="card">
      <div class="titulo">Saldo de Movimenta√ß√µes (dia)</div>
      <div class="valor" [class.positivo]="saldoMovimentacoesHoje >= 0" [class.negativo]="saldoMovimentacoesHoje < 0">
        R$ {{ saldoMovimentacoesHoje | number:'1.2-2' }}
      </div>
    </div>
    <div class="card">
      <div class="titulo">Total no Caixa (vendas + movs)</div>
      <div class="valor" [class.positivo]="totalNoCaixaHoje >= 0" [class.negativo]="totalNoCaixaHoje < 0">
        R$ {{ totalNoCaixaHoje | number:'1.2-2' }}
      </div>
    </div>
  </div>

  <div class="mensagens">
    <div class="erro" *ngIf="error" (click)="error = ''" (keydown.enter)="error = ''" (keydown.space)="error = ''">{{ error }}</div>
    <div class="sucesso" *ngIf="success" (click)="success = ''" (keydown.enter)="success = ''" (keydown.space)="success = ''">{{ success }}</div>
  </div>

  <div class="lista">
    <h3>Movimenta√ß√µes do dia</h3>
    <div class="vazia" *ngIf="!movimentacoes || movimentacoes.length === 0">Sem movimenta√ß√µes</div>
    <div class="item" *ngFor="let m of movimentacoes">
      <div class="col tipo">
        <span class="badge" [ngClass]="{entrada: m.tipo === 'entrada', retirada: m.tipo === 'retirada', venda: m.tipo === 'venda'}">
          <span class="icon" *ngIf="m.tipo === 'entrada'">‚ûï</span>
          <span class="icon" *ngIf="m.tipo === 'retirada'">‚ûñ</span>
          <span class="icon" *ngIf="m.tipo === 'venda'">üõí</span>
          <span class="label">{{ m.tipo }}</span>
        </span>
      </div>
      <div class="col produto">{{ m.produto_nome || '-' }}</div>
      <div class="col valor">R$ {{ m.valor | number:'1.2-2' }}</div>
      <div class="col descricao">{{ m.descricao || '-' }}</div>
      <div class="col usuario">{{ m.usuario || '-' }}</div>
      <div class="col data">{{ m.data_movimento | date:'short' }}</div>
    </div>
  </div>
</div>


